# Migration `20200731091924-create-views-model`

This migration has been generated by William Lindvall at 7/31/2020, 9:19:24 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."View" (
"id" SERIAL,
"linkId" integer  NOT NULL ,
PRIMARY KEY ("id"))

ALTER TABLE "public"."Link" DROP COLUMN "views";

ALTER TABLE "public"."View" ADD FOREIGN KEY ("linkId")REFERENCES "public"."Link"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200730235017-add-link-views..20200731091924-create-views-model
--- datamodel.dml
+++ datamodel.dml
@@ -1,9 +1,9 @@
 // https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -15,9 +15,9 @@
   target              String
   createdAt           DateTime  @default(now())
   author              User?     @relation("PublishedLinks", fields: [authorId], references: [id])
   authorId            Int?
-  views               Int       @default(0)
+  views               View[]    @relation("Views")
   title               String?
   desc                String?
   og_title            String?
   og_desc             String?
@@ -33,8 +33,14 @@
   google_desc         String?
   google_img_src      String?
 }
+model View {
+  id                  Int       @default(autoincrement()) @id
+  link                Link      @relation("Views", fields: [linkId], references: [id])
+  linkId              Int
+}
+
 model User {
   id                  Int       @default(autoincrement()) @id
   email               String    @unique
   createdAt           DateTime  @default(now())
```


