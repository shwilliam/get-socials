# Migration `20200727211931-create-users`

This migration has been generated by William Lindvall at 7/27/2020, 9:19:31 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Link" (
"id" SERIAL,
"slug" text  NOT NULL ,
"target" text  NOT NULL ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"authorId" integer   ,
"title" text   ,
"desc" text   ,
"og_title" text   ,
"og_desc" text   ,
"og_img_src" text   ,
"og_site" text   ,
"twitter_title" text   ,
"twitter_desc" text   ,
"twitter_img_alt" text   ,
"twitter_img_src" text   ,
"twitter_site_acc" text   ,
"twitter_author_acc" text   ,
"google_title" text   ,
"google_desc" text   ,
"google_img_src" text   ,
PRIMARY KEY ("id"))

CREATE TABLE "public"."User" (
"id" SERIAL,
"email" text  NOT NULL ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY ("id"))

CREATE UNIQUE INDEX "Link.slug" ON "public"."Link"("slug")

CREATE UNIQUE INDEX "User.email" ON "public"."User"("email")

ALTER TABLE "public"."Link" ADD FOREIGN KEY ("authorId")REFERENCES "public"."User"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200725005529-add-links-meta-fields..20200727211931-create-users
--- datamodel.dml
+++ datamodel.dml
@@ -1,9 +1,9 @@
 // https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -13,9 +13,10 @@
   id                  Int       @default(autoincrement()) @id
   slug                String    @unique
   target              String
   createdAt           DateTime  @default(now())
-  author              String?
+  author              User?     @relation("PublishedLinks", fields: [authorId], references: [id])
+  authorId            Int?
   title               String?
   desc                String?
   og_title            String?
   og_desc             String?
@@ -30,4 +31,11 @@
   google_title        String?
   google_desc         String?
   google_img_src      String?
 }
+
+model User {
+  id                  Int       @default(autoincrement()) @id
+  email               String    @unique
+  createdAt           DateTime  @default(now())
+  links               Link[]    @relation("PublishedLinks")
+}
```


